{
  "scopeName": "source.cscd",
  "name": "CSCD",
  "patterns": [
    { "include": "#format_markers" },
    { "include": "#comments" },
    { "include": "#metadata" },
    { "include": "#collections" },
    { "include": "#primitives" },
    { "include": "#symbols" },
    { "include": "#delimiters"}
  ],
  "repository": {

    "format_markers": {
      "patterns": [
        {
          "name": "cscd.markers.header",
          "match": "~CSCD~"
        },
        {
          "name": "cscd.markers.footer",
          "match": "~/CSCD~"
        }
      ]
    },



    "comments": {
      "patterns": [
        {
          "name": "cscd.comment",
          "begin": ";;",
          "end": ";;"
        }
      ]
    },



    "metadata": {
      "patterns": [
        {
          "name": "cscd.metadata.address",
          "begin": "`",
          "end": "`",
          "patterns": [
            {
              "name": "cscd.escapes.address",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },
        {
          "name": "cscd.metadata.type",
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "name": "cscd.escapes.type",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },
        {
          "name": "cscd.metadata.scope",
          "begin": "\\^",
          "end": "\\^",
          "patterns": [
            {
              "name": "cscd.escapes.scope",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },
        {
          "name": "cscd.metadata.offset",
          "match": "\\|Z\\||\\|[+-]\\d+(:\\d+)?\\|"
        }
      ]
    },



    "collections": {
      "patterns": [
        {
          "name": "cscd.collections.list",
          "begin": "\\[",
          "end": "\\]",
          "beginCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "endCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "patterns": [
            { "include": "#format_markers" },
            { "include": "#comments" },
            { "include": "#metadata" },
            { "include": "#primitives" },
            { "include": "#collections" },
            { "include": "#delimiters" }
          ]
        },
        {
          "name": "cscd.collections.dictionary",
          "begin": "\\{",
          "end": "\\}",
          "beginCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "endCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "patterns": [
            { "include": "#format_markers" },
            { "include": "#comments" },
            { "include": "#metadata" },
            { "include": "#primitives" },
            { "include": "#collections" },
            { "include": "#delimiters" }
          ]
        },
        {
          "name": "cscd.collections.object",
          "begin": "\\<",
          "end": "\\>",
          "beginCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "endCaptures": {
            "0": { "name": "cscd.punctuation" }
          },
          "patterns": [
            { "include": "#membernames" },
            { "include": "#format_markers" },
            { "include": "#comments" },
            { "include": "#metadata" },
            { "include": "#primitives" },
            { "include": "#collections" },
            { "include": "#delimiters" }
          ]
        }
      ]
    },



    "primitives": {
      "patterns": [
        {
          "name": "cscd.primitives.string",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "cscd.escapes.string",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },
        {
          "name": "cscd.primitives.character",
          "match": "'''"
        },
        {
          "name": "cscd.primitives.character",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "cscd.escapes.character",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },

        {
          "name": "cscd.primitives.duration",
          "match": "-?\\d+d"
        },
        {
          "name": "cscd.primitives.duration",
          "match": "-?\\d+h"
        },
        {
          "name": "cscd.primitives.duration",
          "match": "-?\\d+m"
        },
        {
          "name": "cscd.primitives.duration",
          "match": "-?(\\d+|(?:\\d*\\.\\d+|\\d+\\.|\\.|\\d+[e][+-]?\\d+)(?:[e][+-]?\\d+)?)s"
        },
        
        {
          "name": "cscd.primitives.decimal",
          "match": "-?\\$\\d*(\\.\\d*)?"
        },
        {
          "name": "cscd.primitives.float",
          "match": "-?(?:\\d*\\.\\d+|\\d+\\.|\\.|\\d+[e][+-]?\\d+)(?:[e][+-]?\\d+)?"
        },
        {
          "name": "cscd.primitives.integer",
          "match": "-?\\b\\d+\\b"
        },
        
        {
          "name": "cscd.primitives.null",
          "match": "\\bnull\\b"
        },
        {
          "name": "cscd.primitives.boolean",
          "match": "\\b(true|false)\\b"
        },
        {
          "name": "cscd.primitives.nan",
          "match": "\\bnan\\b"
        },
        {
          "name": "cscd.primitives.infinity",
          "match": "-?\\binf\\b"
        },
        
        {
          "name": "cscd.primitives.color",
          "match": "#[0-9A-F]{0,8}"
        },

        {
          "name": "cscd.primitives.uid",
          "match": "%[0-9a-fA-F]{0,8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
        },
        {
          "name": "cscd.primitives.uid",
          "match": "%[0-9a-fA-F]{0,4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
        },
        {
          "name": "cscd.primitives.uid",
          "match": "%[0-9a-fA-F]{0,4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}"
        },
        {
          "name": "cscd.primitives.uid",
          "match": "%[0-9a-fA-F]{0,4}-[0-9a-fA-F]{12}"
        },
        {
          "name": "cscd.primitives.uid",
          "match": "%[0-9a-f]{0,32}"
        },


        {
          "name": "cscd.primitives.timestamp",
          "begin": "@",
          "end": "@"
        },

        {
          "name": "cscd.primitives.bytes",
          "match": "![A-Za-z0-9+/=]*"
        },


        {
          "name": "cscd.primitives.reference",
          "begin": "&",
          "end": "&",
          "patterns": [
            {
              "name": "cscd.escapes.reference",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },


        {
          "name": "cscd.primitives.symbol",
          "begin": "\\*",
          "end": "\\*",
          "patterns": [
            {
              "name": "cscd.escapes.symbol",
              "match": "\\\\(t|n|r|\"|'|\\\\|\\(|\\)|\\*|\\^|&|`|[0-9A-F]+;)"
            }
          ]
        },
        {
          "name": "cscd.primitives.symbol",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b"
        }
      ]
    },


    "membernames": {
      "patterns": [
        {
          "name": "cscd.primitives.membername",
          "match": "\\*[A-Za-z_][A-Za-z0-9_]*\\*(?=\\s*:)"
        },
        {
          "name": "cscd.primitives.membername",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b(?=\\s*:)"
        }
      ]
    },

    "delimiters": {
      "patterns": [
        {
          "name": "cscd.punctuation",
          "match": "\\["
        },
        {
          "name": "cscd.punctuation",
          "match": "\\]"
        },
        {
          "name": "cscd.punctuation",
          "match": "\\{"
        },
        {
          "name": "cscd.punctuation",
          "match": "\\}"
        },
        {
          "name": "cscd.punctuation",
          "match": "\\<"
        },
        {
          "name": "cscd.punctuation",
          "match": "\\>"
        },
        {
          "name": "cscd.punctuation",
          "match": ","
        },
        {
          "name": "cscd.punctuation",
          "match": ":"
        }
      ]
    }
  }
}